# LangGraphæ™ºèƒ½ä½“å¼€å‘ç³»ç»Ÿå®ç°

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ
### é…ç½®æ–‡ä»¶è¯´æ˜ (config.py)

#### ğŸ”§ åŸºç¡€é…ç½®
| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `LOG_PATH` | æ—¥å¿—æ–‡ä»¶å­˜å‚¨è·¯å¾„ | é¡¹ç›®æ ¹ç›®å½•/logs |
| `TEMP_DIR_PATH` | ä¸´æ—¶æ–‡ä»¶ä¸Šä¼ ç›®å½• | temp/upload_files |
| `LOG_FORMAT` | æ—¥å¿—è¾“å‡ºæ ¼å¼ | æ—¶é—´-æ–‡ä»¶-è¡Œå·-çº§åˆ«-æ¶ˆæ¯ |

#### ğŸ” å®‰å…¨ä¸è®¤è¯
| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼                                        |
|------|------|--------------------------------------------|
| `SECRET_KEY` | JWTè®¤è¯å¯†é’¥ | zhisuan-secret-key                         |
| `ALGORITHM` | JWTåŠ å¯†ç®—æ³• | HS256                                      |
| `ACCESS_TOKEN_EXPIRE_MINUTES` | è®¿é—®ä»¤ç‰Œæœ‰æ•ˆæœŸ | 3åˆ†é’Ÿ                                        |
| `USERS` | ç”¨æˆ·ä¿¡æ¯é…ç½® | åŒ…å«adminç”¨æˆ·ä¿¡æ¯ ï¼ˆå¯è‡ªè¡Œè®¾ç½®ï¼ˆæ³¨æ„å¯†ç åªèƒ½è®¾ç½®ä¸ºå“ˆå¸Œå€¼ï¼Œä¸è¦è¾“å…¥æ™®é€šå¯†ç ï¼‰ï¼‰ |

#### ğŸ¤– æ¨¡å‹ä¸API
| å‚æ•° | è¯´æ˜                     | é»˜è®¤å€¼                    |
|------|------------------------|------------------------|
| `AGENT_LLM_MODELS` | æ™ºèƒ½ä½“LLMæ¨¡å‹åˆ—è¡¨ï¼ˆä¸­é—´èŠ‚ç‚¹ä½¿ç”¨çš„æ¨¡å‹ï¼‰  | ["qwen-14B"]ï¼ˆæ ¹æ®å®é™…ä½¿ç”¨ä¿®æ”¹ï¼‰ |
| `COT_LLM_MODELS` | æ€ç»´é“¾æ¨¡å‹åˆ—è¡¨ï¼ˆæœ€ç»ˆå›å¤ç”¨æˆ·é—®é¢˜ä½¿ç”¨çš„æ¨¡å‹ï¼‰ | ["qwen-14B"]   ï¼ˆæ ¹æ®å®é™…ä½¿ç”¨ä¿®æ”¹ï¼‰        |
| `LLM_MODEL_API` | æ¨¡å‹APIè¯¦ç»†é…ç½®              | åŒ…å«APIåœ°å€ã€å¯†é’¥ç­‰   ï¼ˆæ ¹æ®å®é™…ä½¿ç”¨ä¿®æ”¹ï¼‰         |

#### ğŸ“š çŸ¥è¯†åº“ä¸æ£€ç´¢
| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼                                                               |
|------|------|-------------------------------------------------------------------|
| `KNOWLEDGE_BASE_API` | çŸ¥è¯†åº“APIåœ°å€ | http://127.0.0.1:9996/api/v0/search/multi ï¼ˆå°æ™ºæ–‡æ¡£çš„è¿æ¥ä¿¡æ¯ï¼Œæ ¹æ®å®é™…ä½¿ç”¨ä¿®æ”¹ç«¯å£ç­‰ï¼‰ |
| `TOKEN` | çŸ¥è¯†åº“è®¿é—®ä»¤ç‰Œ | eyJhbGciOiJIUzI1NiIsInR5cCI...                                    |
| `DEFAULT_TOP_K` | æ£€ç´¢å€™é€‰ç»“æœæ•°é‡ | 40                                                                |
| `DEFAULT_TOP_N` | æœ€ç»ˆé€‰æ‹©æ–‡æ¡£æ•°é‡ | 3                                                                 |
| `DEFAULT_KEY_WEIGHT` | å…³é”®è¯æƒé‡ | 0.8                                                               |
| `DIFY_compatible` | æ˜¯å¦å…¼å®¹Difyæ ¼å¼ | False                                                             |

#### ğŸ“„ æ–‡æ¡£å¤„ç†
| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `FILE_EXTRACTION_API` | æ–‡æ¡£æå–API | http://127.0.0.1:9996/api/v0/read/deep-multi-analyze ï¼ˆå°æ™ºæ–‡æ¡£çš„è¿æ¥ä¿¡æ¯ï¼Œæ ¹æ®å®é™…ä½¿ç”¨ä¿®æ”¹ç«¯å£ç­‰ï¼‰|
| `FILE_EXTRACTION_BODY` | æå–å‚æ•°é…ç½® | åŒ…å«è¡¨æ ¼æå–ã€é¡µé¢èŒƒå›´ç­‰å‚æ•° |
| `MAX_DOC_CONTENT_LENGTH` | æ–‡æ¡£å†…å®¹é•¿åº¦é™åˆ¶ | 80000å­—ç¬¦ |
| `allowed_extensions` | æ”¯æŒçš„æ–‡ä»¶ç±»å‹ | txt, md, pdf, docx, xlsxç­‰ |
| `max_size` | ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶ | 10MB |

#### âš™ï¸ æ¨¡å‹é™åˆ¶
| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `MAX_INPUT_TOKENS` | æœ€å¤§è¾“å…¥tokenæ•° | 22000 |
| `MAX_PROMPT_TOKENS` | æœ€å¤§æç¤ºè¯tokenæ•° | 32000 |

#### ğŸ› ï¸ å®ç”¨æ–¹æ³•
| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `load_from_json()` | ä»JSONæ–‡ä»¶åŠ è½½é…ç½® |
| `reload()` | é‡æ–°åŠ è½½é…ç½®ï¼ˆç¯å¢ƒå˜é‡+é…ç½®æ–‡ä»¶ï¼‰ |
| `get_config()` | è·å–é…ç½®å•ä¾‹ |
| `log_time()` | è£…é¥°å™¨ï¼šè®°å½•å‡½æ•°æ‰§è¡Œæ—¶é—´ |

> **æ³¨æ„**ï¼šé…ç½®å¯é€šè¿‡ç¯å¢ƒå˜é‡ï¼ˆä½¿ç”¨`APP_`å‰ç¼€ï¼‰æˆ–é…ç½®æ–‡ä»¶åŠ¨æ€åŠ è½½å’Œæ›´æ–°ã€‚

ä½¿ç”¨æ—¶å¯æ ¹æ®å®é™…éƒ¨ç½²ç¯å¢ƒä¿®æ”¹ç›¸åº”é…ç½®æ–‡ä»¶å‚æ•°ã€‚

### æ–¹æ¡ˆä¸€ï¼šDockerå®¹å™¨åŒ–éƒ¨ç½²
```bash
# å…‹éš†ä»£ç åº“
git clone http://192.168.5.221:8081/llmgp/deployment_ex.git  --branch langGraph-0.2.0 langchainGraph
cd langchainGraph

# æ„å»ºå¹¶å¯åŠ¨å®¹å™¨
# é¦–å…ˆæŸ¥çœ‹ç«¯å£å ç”¨ï¼š
for port in 8116 7861; do
  ss -tuln | grep ":$port " &>/dev/null && \
      echo "âŒ ç«¯å£ $port è¢«å ç”¨" || \
      echo "âœ… ç«¯å£ $port å¯ç”¨"
done
cp Dockerfile.bak Dockerfile
cp docker-compose.yml.bak docker-compose.yml

# ä¿®æ”¹docker docker-compose.yamlæ–‡ä»¶å†…è¢«å ç”¨çš„ç«¯å£

docker compose build
docker compose up -d

# æ—¥å¸¸ç»´æŠ¤ï¼š
docker compose restart
```
### æ–¹æ¡ˆäºŒï¼šæºç ç›´æ¥éƒ¨ç½²
```bash
# å…‹éš†ä»£ç åº“
git clone http://192.168.5.221:8081/llmgp/deployment_ex.git  --branch langGraph-0.2.0 langGraph
cd langGraph

# å®‰è£…ä¾èµ–
pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/ --default-timeout 250

# å¯åŠ¨æœåŠ¡
python service.py
```
### ğŸ”„ æ›´æ–°æŒ‡å—
```bash
# ä»£ç æ›´æ–°
git pull

# å®¹å™¨éƒ¨ç½²æ›´æ–°
docker compose restart  # ä»…ä»£ç å˜æ›´æ—¶

# æ¶‰åŠåŒ…æ›´æ–°çš„æƒ…å†µï¼ˆè¿›å…¥å®¹å™¨æ“ä½œï¼‰
docker exec -it <name> /bin/bash
pip install -r requirements.txt
```
